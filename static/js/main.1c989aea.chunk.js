(this.webpackJsonpjawa=this.webpackJsonpjawa||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(5),c=n.n(s),o=(n(12),n(13),n(1)),u=n.n(o),i=n(2),l=n(3),f=36e5,m=12e5,p=[8,16,19];function d(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n+=1){var a=e.attributes.item(n);t["@attributes"][a.nodeName]=a.nodeValue}}}else 3===e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes()&&1===e.childNodes.length&&3===e.childNodes[0].nodeType)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var r=0;r<e.childNodes.length;r+=1){var s=e.childNodes.item(r),c=s.nodeName;if("undefined"===typeof t[c])t[c]=d(s);else{if("undefined"===typeof t[c].push){var o=t[c];t[c]=[],t[c].push(o)}t[c].push(d(s))}}return t}var h=function(e){for(var t=e.forecast,n=[],a=0;a<t.length;a++){var r=t[a];-1!==p.indexOf(r.ts.getHours())&&n.push(r)}return n};function w(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,e.next=3,fetch(n);case 3:return a=e.sent,e.t0=d,e.t1=new DOMParser,e.next=8,a.text();case 8:return e.t2=e.sent,e.t3=e.t1.parseFromString.call(e.t1,e.t2,"text/xml"),e.abrupt("return",(0,e.t0)(e.t3));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return E.apply(this,arguments)}function E(){return(E=Object(i.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.place,(a=new Date(Date.now())).setTime(a.getTime()+1728e5),e.next=5,w({url:"https://opendata.fmi.fi/wfs?request=getFeature&storedquery_id=fmi::forecast::harmonie::surface::point::simple&place=".concat(n,"&parameters=temperature&endtime=").concat(a.toISOString())});case 5:return r=e.sent,e.abrupt("return",r["wfs:FeatureCollection"]&&r["wfs:FeatureCollection"]["wfs:member"]?{ts:new Date(r["wfs:FeatureCollection"]["@attributes"].timeStamp),forecast:h({forecast:r["wfs:FeatureCollection"]["wfs:member"].map((function(e){return{ts:new Date(e["BsWfs:BsWfsElement"]["BsWfs:Time"]),temp:Number(e["BsWfs:BsWfsElement"]["BsWfs:ParameterValue"])}}))})}:{});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.place,(a=new Date(Date.now())).setTime(a.getTime()-36e5),e.next=5,w({url:"https://opendata.fmi.fi/wfs?request=getFeature&storedquery_id=fmi::observations::weather::simple&place=".concat(n,"&parameters=temperature&starttime=").concat(a.toISOString())});case 5:return r=e.sent,e.abrupt("return",r["wfs:FeatureCollection"]&&r["wfs:FeatureCollection"]["wfs:member"]?{ts:new Date(r["wfs:FeatureCollection"]["@attributes"].timeStamp),observation:{ts:new Date(r["wfs:FeatureCollection"]["wfs:member"][r["wfs:FeatureCollection"]["wfs:member"].length-1]["BsWfs:BsWfsElement"]["BsWfs:Time"]),temp:Number(r["wfs:FeatureCollection"]["wfs:member"][r["wfs:FeatureCollection"]["wfs:member"].length-1]["BsWfs:BsWfsElement"]["BsWfs:ParameterValue"])}}:{});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var t=e.ts,n=e.temp;return r.a.createElement("div",null,t.toLocaleString("fi-FI"),": ",Math.round(n)," \xb0C")}var y=n(6);function F(e){var t=e.ts,n=Object(a.useState)(0),s=Object(l.a)(n,2),c=s[0],o=s[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){return o((function(e){return e+1}))}),3e4);return function(){return clearTimeout(e)}}),[c]),r.a.createElement("p",null,"Updated ",Object(y.a)(new Date,t)," ago.")}function x(e){var t=e.data;return r.a.createElement("div",null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{ts:t.observation.ts,temp:t.observation.temp}),r.a.createElement(F,{ts:t.ts})):"")}function D(e){var t=e.data;return r.a.createElement("div",null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,t.forecast.map((function(e,t){return r.a.createElement(j,{key:t,ts:e.ts,temp:e.temp})}))),r.a.createElement(F,{ts:t.ts})):"")}function B(e){var t=e.place,n=e.observationData,a=e.forecastData;return r.a.createElement("div",null,r.a.createElement("p",null,"Forecast of"),r.a.createElement("h1",null,t),r.a.createElement("div",null,r.a.createElement(x,{data:n}),r.a.createElement(D,{data:a})))}var C=3e4;function T(e){var t=e.place,n=Object(a.useState)(void 0),s=Object(l.a)(n,2),c=s[0],o=s[1],p=Object(a.useState)(void 0),d=Object(l.a)(p,2),h=d[0],w=d[1],v=Object(a.useState)(0),E=Object(l.a)(v,2),O=E[0],j=E[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){return j((function(e){return e+1}))}),C);return function(){return clearTimeout(e)}}),[O]),Object(a.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o,e.next=3,b({place:t});case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(!c||c&&c.ts&&Date.now()-c.ts>f)&&function(){e.apply(this,arguments)}()}),[O,t,c]),Object(a.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=w,e.next=3,g({place:t});case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(!h||h&&h.ts&&Date.now()-h.ts>m)&&function(){e.apply(this,arguments)}()}),[O,t,h]),r.a.createElement(B,{place:t,observationData:h,forecastData:c})}var W="Tampere";var N=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(T,{place:W})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports=n(15)}},[[7,1,2]]]);
//# sourceMappingURL=main.1c989aea.chunk.js.map