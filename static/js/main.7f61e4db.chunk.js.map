{"version":3,"sources":["utils.js","api.js","config.js","components/Temperature.js","components/TempTsPair.js","components/Observation.js","components/Timestamp.js","components/Forecast.js","components/Weather.js","components/DataLayer.js","App.js","serviceWorker.js","index.js"],"names":["xmlToJson","xml","obj","nodeType","attributes","length","j","attribute","item","nodeName","nodeValue","hasChildNodes","childNodes","i","push","old","makeArraySortedByKey","Object","keys","map","key","sort","first","second","convertToForecastData","tsByValuesObject","reduce","previousValue","value","ts","fromUnixTime","tsStartOfHour","startOfHour","tsStartOfHourUnix","getUnixTime","startOfDayUnix","startOfDay","g","items","h","timestampsToValuesObject","responseData","currentValue","Date","tsUnix","name","Number","valueWithHighestKey","arr","lastItem","fetchXml","a","url","fetch","result","DOMParser","text","parseFromString","fetchForecast","place","endTime","endOfDay","addHours","now","toISOString","fetchObservation","startTime","observations","FORECAST_REFRESH_INTERVAL","OBSERVATION_REFRESH_INTERVAL","INTERESTING_HOURS","Temperature","temp","className","Math","round","Wind","windspeedms","isNaN","Precipitation","precipitation1h","TempTsPair","includeMinutes","temperature","Observation","data","Timestamp","format","isToday","isTomorrow","ForOneDay","dayData","filtered","filter","v","indexOf","getHours","Array","_","index2","Forecast","d","index1","Weather","observationData","forecastData","DATA_CHECK_INTERVAL","DataLayer","useState","undefined","setForecastData","lastForecastDataAttempt","setLastForecastDataAttempt","setObservationData","lastObservationDataAttempt","setLastObservationDataAttempt","mark","setMark","useEffect","timer","setTimeout","m","clearTimeout","logData","console","log","fetchData","PLACE","App","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.7f61e4db.chunk.js","sourcesContent":["// https://gist.github.com/demircancelebi/f0a9c7e1f48be4ea91ca7ad81134459d\nexport function xmlToJson(xml) {\n  // Create the return object\n  let obj = {};\n\n  if (xml.nodeType === 1) {\n    // element\n    // do attributes\n    if (xml.attributes.length > 0) {\n      obj[\"@attributes\"] = {};\n      for (let j = 0; j < xml.attributes.length; j += 1) {\n        const attribute = xml.attributes.item(j);\n        obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\n      }\n    }\n  } else if (xml.nodeType === 3) {\n    // text\n    obj = xml.nodeValue;\n  }\n\n  // do children\n  // If just one text node inside\n  if (\n    xml.hasChildNodes() &&\n    xml.childNodes.length === 1 &&\n    xml.childNodes[0].nodeType === 3\n  ) {\n    obj = xml.childNodes[0].nodeValue;\n  } else if (xml.hasChildNodes()) {\n    for (let i = 0; i < xml.childNodes.length; i += 1) {\n      const item = xml.childNodes.item(i);\n      const nodeName = item.nodeName;\n      if (typeof obj[nodeName] === \"undefined\") {\n        obj[nodeName] = xmlToJson(item);\n      } else {\n        if (typeof obj[nodeName].push === \"undefined\") {\n          const old = obj[nodeName];\n          obj[nodeName] = [];\n          obj[nodeName].push(old);\n        }\n        obj[nodeName].push(xmlToJson(item));\n      }\n    }\n  }\n  return obj;\n}\n","import { xmlToJson } from \"./utils\";\nimport {\n  startOfDay,\n  getUnixTime,\n  fromUnixTime,\n  endOfDay,\n  addHours,\n  startOfHour\n} from \"date-fns\";\n\nfunction makeArraySortedByKey(obj) {\n  return Object.keys(obj)\n    .map(function(key) {\n      return [key, obj[key]];\n    })\n    .sort(function(first, second) {\n      return first[0] - second[0];\n    });\n}\n\nfunction convertToForecastData({ tsByValuesObject }) {\n  return makeArraySortedByKey(\n    Object.keys(tsByValuesObject).reduce((previousValue, key) => {\n      const value = tsByValuesObject[key];\n\n      const ts = fromUnixTime(key);\n      const tsStartOfHour = startOfHour(ts);\n\n      // getUnixTime so that the timestamp can be put to object as a key\n      const tsStartOfHourUnix = getUnixTime(tsStartOfHour);\n      const startOfDayUnix = getUnixTime(startOfDay(ts));\n\n      previousValue[startOfDayUnix] = {\n        ...previousValue[startOfDayUnix],\n        [tsStartOfHourUnix]: {\n          ...(previousValue[startOfDayUnix]\n            ? previousValue[startOfDayUnix][tsStartOfHourUnix]\n            : {}),\n          ...value\n        }\n      };\n\n      return previousValue;\n    }, {})\n  ).map(g => ({\n    startOfDay: fromUnixTime(g[0]),\n    items: makeArraySortedByKey(g[1]).map(h => ({\n      ts: fromUnixTime(h[0]),\n      ...h[1]\n    }))\n  }));\n}\n\nfunction timestampsToValuesObject({ responseData }) {\n  return responseData[\"wfs:FeatureCollection\"][\"wfs:member\"].reduce(\n    (previousValue, currentValue) => {\n      // console.log(previousValue, currentValue);\n      const item = currentValue[\"BsWfs:BsWfsElement\"];\n\n      const ts = new Date(item[\"BsWfs:Time\"]);\n\n      // getUnixTime so that the timestamp can be put to object as a key\n      const tsUnix = getUnixTime(ts);\n\n      const name = item[\"BsWfs:ParameterName\"];\n      const value = Number(item[\"BsWfs:ParameterValue\"]);\n\n      previousValue[tsUnix] = {\n        ...previousValue[tsUnix],\n        ...{ [name]: value }\n      };\n\n      return previousValue;\n    },\n    {}\n  );\n}\n\nfunction valueWithHighestKey({ obj }) {\n  const arr = makeArraySortedByKey(obj);\n  const lastItem = arr[arr.length - 1];\n  return {\n    key: lastItem[0],\n    value: lastItem[1]\n  };\n}\n\nasync function fetchXml({ url }) {\n  const result = await fetch(url);\n  return xmlToJson(\n    new DOMParser().parseFromString(await result.text(), \"text/xml\")\n  );\n}\n\nexport async function fetchForecast({ place }) {\n  const endTime = endOfDay(addHours(Date.now(), 2 * 24));\n\n  const responseData = await fetchXml({\n    url: `https://opendata.fmi.fi/wfs?request=getFeature&storedquery_id=fmi::forecast::harmonie::surface::point::simple&place=${place}&parameters=temperature,windspeedms,precipitation1h&endtime=${endTime.toISOString()}`\n  });\n\n  return convertToForecastData({\n    tsByValuesObject: timestampsToValuesObject({ responseData })\n  });\n}\n\nexport async function fetchObservation({ place }) {\n  const startTime = addHours(Date.now(), -1);\n\n  const responseData = await fetchXml({\n    url: `https://opendata.fmi.fi/wfs?request=getFeature&storedquery_id=fmi::observations::weather::simple&place=${place}&parameters=temperature,windspeedms,precipitation1h&starttime=${startTime.toISOString()}`\n  });\n\n  const { key: ts, value: observations } = valueWithHighestKey({\n    obj: timestampsToValuesObject({ responseData })\n  });\n\n  return {\n    ts: fromUnixTime(ts),\n    ...observations\n  };\n}\n","export const FORECAST_REFRESH_INTERVAL = 60 * 60 * 1000;\nexport const OBSERVATION_REFRESH_INTERVAL = 20 * 60 * 1000;\nexport const INTERESTING_HOURS = [8, 16, 19];\n","import React from \"react\";\n\nexport function Temperature({ temp }) {\n  return (\n    <div className=\"temperature\">\n      <span className=\"temperature-number\">{Math.round(temp)}</span>\n      <span className=\"temperature-degree\">°C</span>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Temperature } from \"./Temperature\";\nimport { format } from \"date-fns\";\n\nfunction Wind({ windspeedms }) {\n  let className = \"light-text\";\n  let text = \"\";\n\n  if (isNaN(windspeedms)) {\n    text = \"(ei tuulitietoa)\";\n  } else {\n    if (windspeedms > 6) {\n      className = \"warning-text\";\n      text = `Kova tuuli (${Math.round(windspeedms)} m/s)`;\n    } else if (windspeedms > 4) {\n      text = \"Kohtalainen tuuli\";\n    } else if (windspeedms > 3) {\n      text = \"Kevyt tuuli\";\n    }\n  }\n\n  return <div className={className}>{text}</div>;\n}\n\nfunction Precipitation({ precipitation1h }) {\n  let className = \"light-text\";\n  let text = \"\";\n\n  if (isNaN(precipitation1h)) {\n    text = \"(ei sadetietoa)\";\n  } else {\n    if (precipitation1h > 1) {\n      className = \"warning-text\";\n      text = `Kova sade (${Math.round(precipitation1h)} mm/h)`;\n    } else if (precipitation1h > 0.5) {\n      text = \"Kohtalainen sade\";\n    } else if (precipitation1h > 0) {\n      text = \"Kevyt sade\";\n    }\n  }\n\n  return <div className={className}>{text}</div>;\n}\n\nexport function TempTsPair(\n  { ts, temperature, windspeedms, precipitation1h, includeMinutes } = {\n    includeMinutes: false\n  }\n) {\n  return (\n    <div>\n      {/* <span className=\"time\">\n        klo {format(ts, \"HH\" + (includeMinutes ? \":mm\" : \"\"))}\n      </span> */}\n      {isNaN(temperature) ? (\n        \"(ei lämpötilatietoa)\"\n      ) : (\n        <Temperature temp={Math.round(temperature)} />\n      )}\n      <Wind windspeedms={windspeedms} />\n      <Precipitation precipitation1h={precipitation1h} />\n    </div>\n  );\n}\n","import React from \"react\";\nimport { TempTsPair } from \"./TempTsPair\";\n\nexport function Observation({ data }) {\n  return (\n    <div>\n      <div className=\"forecast-date\">Nyt</div>\n\n      <div className=\"weather-item\">\n        {data ? (\n          <TempTsPair\n            ts={data[\"ts\"]}\n            temperature={data[\"temperature\"]}\n            windspeedms={data[\"windspeedms\"]}\n            includeMinutes={true}\n          />\n        ) : (\n          \"N/A\"\n        )}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { isToday, isTomorrow, format } from \"date-fns\";\n\nexport function Timestamp({ ts }) {\n  return (\n    <>\n      {format(ts, \"EEEE - \")}\n      {isToday(ts)\n        ? \"Tänään\"\n        : isTomorrow(ts)\n        ? \"Huomenna\"\n        : format(ts, \"d.MM.\")}\n    </>\n  );\n}\n","import React from \"react\";\nimport { TempTsPair } from \"./TempTsPair\";\nimport { Timestamp } from \"./Timestamp\";\nimport { INTERESTING_HOURS } from \"../config\";\nimport { format } from \"date-fns\";\n\nfunction filterByInterestingHours(arr) {\n  return arr.filter(v => INTERESTING_HOURS.indexOf(v[\"ts\"].getHours()) !== -1);\n}\n\nfunction ForOneDay({ dayData }) {\n  const filtered = filterByInterestingHours(dayData[\"items\"]);\n\n  if (filtered.length === 0) {\n    return \"\";\n  }\n\n  return (\n    <>\n      <div className=\"forecast-date\">\n        <Timestamp ts={dayData[\"startOfDay\"]} />\n      </div>\n      <div className=\"weather-container\">\n        {[...Array(INTERESTING_HOURS.length - filtered.length).keys()].map(\n          (_, index2) => (\n            <div key={index2} className=\"weather-item weather-item-empty\"></div>\n          )\n        )}\n        {filtered.map((i, index2) => (\n          <div key={index2} className=\"weather-item\">\n            <div className=\"time\">klo {format(i[\"ts\"], \"HH\")}</div>\n            <div className=\"weather-values\">\n              <TempTsPair\n                ts={i[\"ts\"]}\n                temperature={i[\"temperature\"]}\n                windspeedms={i[\"windspeedms\"]}\n                precipitation1h={i[\"precipitation1h\"]}\n              />\n            </div>\n          </div>\n        ))}\n      </div>\n    </>\n  );\n}\n\nexport function Forecast({ data }) {\n  return (\n    <>\n      {data\n        ? data.map((d, index1) => <ForOneDay key={index1} dayData={d} />)\n        : \"\"}\n    </>\n  );\n}\n","import React from \"react\";\nimport { Observation } from \"./Observation\";\nimport { Forecast } from \"./Forecast\";\n\nexport function Weather({ place, observationData, forecastData }) {\n  return (\n    <div>\n      <h1>{place}</h1>\n      <div>\n        <Observation data={observationData} />\n        <Forecast data={forecastData} />\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { fetchForecast, fetchObservation } from \"../api\";\nimport {\n  FORECAST_REFRESH_INTERVAL,\n  OBSERVATION_REFRESH_INTERVAL\n} from \"../config\";\nimport { Weather } from \"./Weather\";\n\nconst DATA_CHECK_INTERVAL = 30 * 1000;\n\nexport function DataLayer({ place }) {\n  const [forecastData, setForecastData] = useState(undefined);\n  const [lastForecastDataAttempt, setLastForecastDataAttempt] = useState(\n    undefined\n  );\n  const [observationData, setObservationData] = useState(undefined);\n  const [lastObservationDataAttempt, setLastObservationDataAttempt] = useState(\n    undefined\n  );\n  const [mark, setMark] = useState(0);\n\n  useEffect(() => {\n    const timer = setTimeout(() => setMark(m => m + 1), DATA_CHECK_INTERVAL);\n    return () => clearTimeout(timer);\n  }, [mark]);\n\n  useEffect(() => {\n    async function fetchData() {\n      setForecastData(await fetchForecast({ place }));\n    }\n\n    const logData = {\n      forecastData: !!forecastData,\n      lastForecastDataAttempt: lastForecastDataAttempt,\n      \"Date.now() - lastForecastDataAttempt\":\n        lastForecastDataAttempt && Date.now() - lastForecastDataAttempt,\n      FORECAST_REFRESH_INTERVAL: FORECAST_REFRESH_INTERVAL\n    };\n\n    if (\n      !forecastData ||\n      (forecastData &&\n        lastForecastDataAttempt &&\n        Date.now() - lastForecastDataAttempt > FORECAST_REFRESH_INTERVAL)\n    ) {\n      console.log(\"Need forecast data refresh\", logData);\n\n      setLastForecastDataAttempt(Date.now());\n      fetchData();\n    } else {\n      console.log(\"No need for forecast data refresh\", logData);\n    }\n    // eslint-disable-next-line\n  }, [mark, place]);\n\n  useEffect(() => {\n    async function fetchData() {\n      setObservationData(await fetchObservation({ place }));\n    }\n\n    const logData = {\n      observationData: !!observationData,\n      lastObservationDataAttempt: lastObservationDataAttempt,\n      \"Date.now() - lastObservationDataAttempt\":\n        lastObservationDataAttempt && Date.now() - lastObservationDataAttempt,\n      OBSERVATION_REFRESH_INTERVAL: OBSERVATION_REFRESH_INTERVAL\n    };\n\n    if (\n      !observationData ||\n      (observationData &&\n        lastObservationDataAttempt &&\n        Date.now() - lastObservationDataAttempt > OBSERVATION_REFRESH_INTERVAL)\n    ) {\n      console.log(\"Need observation data refresh\", logData);\n\n      setLastObservationDataAttempt(Date.now());\n      fetchData();\n    } else {\n      console.log(\"No need for observation data refresh\", logData);\n    }\n    // eslint-disable-next-line\n  }, [mark, place]);\n\n  return (\n    <Weather\n      place={place}\n      observationData={observationData}\n      forecastData={forecastData}\n    />\n  );\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport { DataLayer } from \"./components/DataLayer\";\n\nconst PLACE = \"Tampere\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <DataLayer place={PLACE} />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}