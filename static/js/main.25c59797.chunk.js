(this.webpackJsonpjawa=this.webpackJsonpjawa||[]).push([[0],{20:function(e,t,n){e.exports=n(29)},26:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),o=n.n(i),c=(n(25),n(26),n(3)),u=(n(27),n(6)),s=n.n(u),l=n(9),m=n(8);function f(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n+=1){var a=e.attributes.item(n);t["@attributes"][a.nodeName]=a.nodeValue}}}else 3===e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes()&&1===e.childNodes.length&&3===e.childNodes[0].nodeType)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var r=0;r<e.childNodes.length;r+=1){var i=e.childNodes.item(r),o=i.nodeName;if("undefined"===typeof t[o])t[o]=f(i);else{if("undefined"===typeof t[o].push){var c=t[o];t[o]=[],t[o].push(c)}t[o].push(f(i))}}return t}function p(e,t,n){var a,r,i;if(0===t)a=r=i=n;else{var o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},c=n<.5?n*(1+t):n+t-n*t,u=2*n-c;a=o(u,c,e+1/3),r=o(u,c,e),i=o(u,c,e-1/3)}return[Math.round(255*a),Math.round(255*r),Math.round(255*i)]}function d(e,t,n){var a=((2*n-1)/1+1)/2,r=1-a;return[Math.round(e[0]*a+t[0]*r),Math.round(e[1]*a+t[1]*r),Math.round(e[2]*a+t[2]*r)]}var b=n(31),v=n(32),O=n(38),g=n(16),h=n(33),j=n(34);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){return Object.keys(e).map((function(t){return[t,e[t]]})).sort((function(e,t){return e[0]-t[0]}))}function N(e){var t=e.tsByValuesObject;return E(Object.keys(t).reduce((function(e,n){var a=t[n],r=Object(b.a)(n),i=Object(v.a)(r),o=Object(O.a)(i),c=Object(O.a)(Object(g.a)(r));return e[c]=y({},e[c],Object(m.a)({},o,y({},e[c]?e[c][o]:{},{},a))),e}),{})).map((function(e){return{startOfDay:Object(b.a)(e[0]),items:E(e[1]).map((function(e){return y({ts:Object(b.a)(e[0])},e[1])}))}}))}function k(e){var t=e.responseData;return(t&&t["wfs:FeatureCollection"]&&t["wfs:FeatureCollection"]["wfs:member"]||[]).reduce((function(e,t){var n=t["BsWfs:BsWfsElement"],a=new Date(n["BsWfs:Time"]),r=Object(O.a)(a),i=n["BsWfs:ParameterName"],o=Number(n["BsWfs:ParameterValue"]);return e[r]=y({},e[r],{},Object(m.a)({},i,o)),e}),{})}function D(e){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,e.next=3,fetch(n);case 3:return a=e.sent,e.t0=f,e.t1=new DOMParser,e.next=8,a.text();case 8:return e.t2=e.sent,e.t3=e.t1.parseFromString.call(e.t1,e.t2,"text/xml"),e.abrupt("return",(0,e.t0)(e.t3));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(s.a.mark((function e(t){var n,a,r,i,o,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.location){e.next=3;break}return e.abrupt("return",void 0);case 3:return a=Object(h.a)(new Date,-1).toISOString(),r=Object(j.a)(Object(h.a)(new Date,72)).toISOString(),i="".concat(n.lat,",").concat(n.lng),o=["request=getFeature","storedquery_id=fmi::forecast::harmonie::surface::point::simple","parameters=temperature,windspeedms,precipitation1h","latlon=".concat(i),"starttime=".concat(a),"endtime=".concat(r)].join("&"),e.next=9,D({url:"https://opendata.fmi.fi/wfs?"+o});case 9:return c=e.sent,u=c&&c["wfs:FeatureCollection"]&&new Date(c["wfs:FeatureCollection"]["@attributes"].timeStamp),e.abrupt("return",{fetchTs:u,items:N({tsByValuesObject:k({responseData:c})})});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=3e4,M=36e5,T=18e5,L=[8,16,19];function C(e){var t=e.temperature;return Number.isFinite(t)?r.a.createElement("div",{className:"temperature"},r.a.createElement("span",{className:"temperature-number"},Math.round(t)),r.a.createElement("span",{className:"temperature-degree"},"\xb0C")):r.a.createElement("div",null,"(ei l\xe4mp\xf6tilatietoa)")}function B(e){var t=e.precipitation1h,n="",a="";return Number.isFinite(t)?t>1?(n="warning-text",a="Voimakas sade (".concat(t.toFixed(1)," mm/h)")):t>.3?a="Kohtalainen sade":t>0&&(n="light-text",a="Heikko sade"):(n="light-text",a="(ei sadetietoa)"),r.a.createElement("div",{className:n},a)}function H(e){var t=e.windspeedms,n="",a="";return Number.isFinite(t)?t>6?(n="warning-text",a="Navakka tuuli (".concat(Math.round(t)," m/s)")):t>4.5?a="Kohtalainen tuuli":t>3&&(n="light-text",a="Heikko tuuli"):(n="light-text",a="(ei tuulitietoa)"),r.a.createElement("div",{className:n},a)}function V(e){var t,n,a=e.temperature,i=e.windspeedms,o="",c="";if(Number.isFinite(a)&&Number.isFinite(i)){var u=(n=i,13.12+.6215*(t=a)-13.956*Math.pow(n,.16)+.4867*t*Math.pow(n,.16)),s=Math.abs(u-a);s<3?c="":(c="Tuntuu kuin ".concat(Math.round(u),"\xb0C"),o=s>7?"warning-text":"light-text")}else c="";return r.a.createElement("div",{className:o},c)}function W(e){var t=e.temperature,n=e.windspeedms,a=e.precipitation1h;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{temperature:t}),r.a.createElement(V,{temperature:t,windspeedms:n}),r.a.createElement(H,{windspeedms:n}),r.a.createElement(B,{precipitation1h:a}))}var J=n(35),I=n(39),q=n(36);function A(e){var t=e.ts;return r.a.createElement(r.a.Fragment,null,["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"][t.getDay()]," - ",Object(J.a)(t)?"T\xe4n\xe4\xe4n":Object(I.a)(t)?"Huomenna":Object(q.a)(t,"d.MM."))}function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeMinutes:!1},t=e.ts,n=e.includeMinutes?"HH:mm":"H";return r.a.createElement("div",{className:"time"},"klo ",Object(q.a)(t,n))}var G=n(12);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e){var t=e.temperature;if(Number.isFinite(t)){var n=p(245/360,.8,.16),a=p(245/360,.85,.12),r=p(340/360,.85,.16),i=p(340/360,.85,.14),o=Math.min(Math.max(1/35*(t- -10),0),1),c="rgb(".concat(d(r,n,o).join(),")"),u="rgb(".concat(d(i,a,o).join(),")");return{backgroundImage:"repeating-linear-gradient(\n      45deg,\n      ".concat(c,",\n      ").concat(c," 0.8em,\n      ").concat(u," 0.8em,\n      ").concat(u," 1.6em\n    )")}}}function Q(e){var t=e.dayData,n=function(e){var t=e.items,n=e.startOfDay,a=[new Date,Object(h.a)(new Date,1),Object(h.a)(new Date,2)].filter((function(e){return Object(G.a)(e,n)})).map((function(e){return e.getHours()})).concat(L);return t.filter((function(e){return-1!==a.indexOf(e.ts.getHours())}))}({items:t.items,startOfDay:t.startOfDay});return 0===n.length?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"forecast-date"},r.a.createElement(A,{ts:t.startOfDay})),r.a.createElement("div",{className:"weather-container"},n.map((function(e,t){return r.a.createElement("div",{key:t,className:"weather-item",style:_({},z({temperature:e.temperature}))},r.a.createElement(K,{ts:e.ts}),r.a.createElement("div",{className:"weather-values"},r.a.createElement(W,{temperature:e.temperature,windspeedms:e.windspeedms,precipitation1h:e.precipitation1h})))}))))}function R(e){var t=e.data;return t?r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement(Q,{key:t,dayData:e})}))):null}var U=n(19),X=n(37);function Y(e){var t=e.ts,n=Object(a.useState)(0),i=Object(c.a)(n,2),o=i[0],u=i[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){return u((function(e){return e+1}))}),3e4);return function(){return clearTimeout(e)}}),[o]),r.a.createElement("p",null,t?r.a.createElement(r.a.Fragment,null,"P\xe4ivitetty"," ",Object(U.a)(new Date,t,{locale:X.a})," ","sitten."):"Ei p\xe4ivitetty")}function Z(e){var t=e.location,n=e.forecastData,a=e.onLocateClick;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"S\xe4\xe4ennuste"),!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"button",onClick:a},"Hae sijainti")),r.a.createElement(R,{data:n&&n.items}),n&&r.a.createElement(Y,{ts:n.fetchTs}))}function ee(e){var t=function(e){var t=e.isLocating,n=e.location,a=e.isLoading,r=e.isError;return t?"Paikannetaan...":n?a?"Tietoja haetaan...":r?"Virhe tietojen haussa.":void 0:"Sijaintitieto tarvitaan ennusteen hakemiseen."}({isLocating:e.isLocating,location:e.location,isLoading:e.isLoading,isError:e.isError});return t?r.a.createElement("div",{className:"status-message"},t):null}function te(e){var t=e.isLocating,n=e.location,i=e.onLocateClick,o=Object(a.useState)(void 0),u=Object(c.a)(o,2),m=u[0],f=u[1],p=Object(a.useState)(void 0),d=Object(c.a)(p,2),b=d[0],v=d[1],O=Object(a.useState)(void 0),g=Object(c.a)(O,2),h=g[0],j=g[1],w=Object(a.useState)(0),y=Object(c.a)(w,2),E=y[0],N=y[1];Object(a.useEffect)((function(){var e=setTimeout((function(){return N((function(e){return e+1}))}),P);return function(){return clearTimeout(e)}}),[E]);var k=Object(a.useState)(!1),D=Object(c.a)(k,2),x=D[0],F=D[1],T=Object(a.useState)(!1),L=Object(c.a)(T,2),C=L[0],B=L[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!1),B(!0),e.prev=2,e.next=5,S({location:n});case 5:t=e.sent,f(t),v(Date.now()),B(!1),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0),F(!0),B(!1);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();!m||JSON.stringify(h)!==JSON.stringify(n)||m&&b&&Date.now()-b>M?(console.log("Need forecast data refresh"),e(),j(n)):console.log("No need for forecast data refresh")}),[E,n]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{isLocating:t,location:n,isLoading:C,isError:x}),r.a.createElement(Z,{location:n,forecastData:m,onLocateClick:i}))}var ne=function(){var e=Object(a.useState)(void 0),t=Object(c.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),u=Object(c.a)(o,2),s=u[0],l=u[1];function m(e){l(!1);var t={lat:e.coords.latitude.toFixed(2),lng:e.coords.longitude.toFixed(2)};JSON.stringify(n)!==JSON.stringify(t)?(console.log("Got new location",t),i(t)):console.log("Got same location")}function f(e){l(!1),console.log(e)}function p(){console.log("Asking for location"),navigator.geolocation?(l(!0),navigator.geolocation.getCurrentPosition(m,f,{maximumAge:18e5})):console.log("No location support")}var d=Object(a.useState)(0),b=Object(c.a)(d,2),v=b[0],O=b[1];return Object(a.useEffect)((function(){var e=void 0;return void 0!==n&&(e=setTimeout((function(){return O((function(e){return e+1}))}),T)),function(){return clearTimeout(e)}}),[v,n]),Object(a.useEffect)((function(){void 0!==n&&p()}),[v]),Object(a.useEffect)((function(){navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then((function(e){console.log(e),"granted"===e.state&&p()}))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(te,{isLocating:s,location:n,onLocateClick:p}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[20,1,2]]]);
//# sourceMappingURL=main.25c59797.chunk.js.map