(this.webpackJsonpjawa=this.webpackJsonpjawa||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),o=a.n(i),c=(a(18),a(3)),s=(a(19),a(4)),u=a.n(s),l=a(5),m=a(8);function f(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var a=0;a<e.attributes.length;a+=1){var n=e.attributes.item(a);t["@attributes"][n.nodeName]=n.nodeValue}}}else 3===e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes()&&1===e.childNodes.length&&3===e.childNodes[0].nodeType)t=e.childNodes[0].nodeValue;else if(e.hasChildNodes())for(var r=0;r<e.childNodes.length;r+=1){var i=e.childNodes.item(r),o=i.nodeName;if("undefined"===typeof t[o])t[o]=f(i);else{if("undefined"===typeof t[o].push){var c=t[o];t[o]=[],t[o].push(c)}t[o].push(f(i))}}return t}var p=a(22),d=a(23),v=a(29),b=a(10),O=a(24),h=a(25);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(a,!0).forEach((function(t){Object(m.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e){return Object.keys(e).map((function(t){return[t,e[t]]})).sort((function(e,t){return e[0]-t[0]}))}function y(e){var t=e.tsByValuesObject;return w(Object.keys(t).reduce((function(e,a){var n=t[a],r=Object(p.a)(a),i=Object(d.a)(r),o=Object(v.a)(i),c=Object(v.a)(Object(b.a)(r));return e[c]=j({},e[c],Object(m.a)({},o,j({},e[c]?e[c][o]:{},{},n))),e}),{})).map((function(e){return{startOfDay:Object(p.a)(e[0]),items:w(e[1]).map((function(e){return j({ts:Object(p.a)(e[0])},e[1])}))}}))}function E(e){var t=e.responseData;return(t&&t["wfs:FeatureCollection"]&&t["wfs:FeatureCollection"]["wfs:member"]||[]).reduce((function(e,t){var a=t["BsWfs:BsWfsElement"],n=new Date(a["BsWfs:Time"]),r=Object(v.a)(n),i=a["BsWfs:ParameterName"],o=Number(a["BsWfs:ParameterValue"]);return e[r]=j({},e[r],{},Object(m.a)({},i,o)),e}),{})}function N(e){return k.apply(this,arguments)}function k(){return(k=Object(l.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,e.next=3,fetch(a);case 3:return n=e.sent,e.t0=f,e.t1=new DOMParser,e.next=8,n.text();case 8:return e.t2=e.sent,e.t3=e.t1.parseFromString.call(e.t1,e.t2,"text/xml"),e.abrupt("return",(0,e.t0)(e.t3));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return D.apply(this,arguments)}function D(){return(D=Object(l.a)(u.a.mark((function e(t){var a,n,r,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.location){e.next=3;break}return e.abrupt("return",void 0);case 3:return n=Object(O.a)(new Date,-1).toISOString(),r=Object(h.a)(Object(O.a)(new Date,72)).toISOString(),i="".concat(a.lat,",").concat(a.lng),e.next=8,N({url:"https://opendata.fmi.fi/wfs?request=getFeature&storedquery_id=fmi::forecast::harmonie::surface::point::simple&latlon=".concat(i,"&parameters=temperature,windspeedms,precipitation1h&starttime=").concat(n,"&endtime=").concat(r)});case 8:return o=e.sent,e.abrupt("return",y({tsByValuesObject:E({responseData:o})}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=3e4,P=36e5,F=18e5,C=[8,16,19];function M(e){var t=e.temperature;return isNaN(t)?r.a.createElement("div",null,"(ei l\xe4mp\xf6tilatietoa)"):r.a.createElement("div",{className:"temperature"},r.a.createElement("span",{className:"temperature-number"},Math.round(t)),r.a.createElement("span",{className:"temperature-degree"},"\xb0C"))}function T(e){var t=e.precipitation1h,a="",n="";return isNaN(t)?(a="light-text",n="(ei sadetietoa)"):t>1?(a="warning-text",n="Voimakas sade (".concat(t.toFixed(1)," mm/h)")):t>.3?n="Kohtalainen sade":t>0&&(a="light-text",n="Heikko sade"),r.a.createElement("div",{className:a},n)}function B(e){var t=e.windspeedms,a="",n="";return isNaN(t)?(a="light-text",n="(ei tuulitietoa)"):t>6?(a="warning-text",n="Navakka tuuli (".concat(Math.round(t)," m/s)")):t>4.5?n="Kohtalainen tuuli":t>3&&(a="light-text",n="Heikko tuuli"),r.a.createElement("div",{className:a},n)}function H(e){var t,a,n=e.temperature,i=e.windspeedms,o="",c="";if(isNaN(n)||isNaN(i))c="";else{var s=(a=i,13.12+.6215*(t=n)-13.956*Math.pow(a,.16)+.4867*t*Math.pow(a,.16)),u=Math.abs(s-n);u<3?c="":(c="Tuntuu kuin ".concat(Math.round(s),"\xb0C"),o=u>7?"warning-text":"light-text")}return r.a.createElement("div",{className:o},c)}function V(e){var t=e.temperature,a=e.windspeedms,n=e.precipitation1h;return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{temperature:t}),r.a.createElement(H,{temperature:t,windspeedms:a}),r.a.createElement(B,{windspeedms:a}),r.a.createElement(T,{precipitation1h:n}))}var W=a(26),J=a(28),L=a(27);function q(e){var t=e.ts;return r.a.createElement(r.a.Fragment,null,["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"][t.getDay()]," - ",Object(W.a)(t)?"T\xe4n\xe4\xe4n":Object(J.a)(t)?"Huomenna":Object(L.a)(t,"d.MM."))}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeMinutes:!1},t=e.ts,a=e.includeMinutes?"HH:mm":"H";return r.a.createElement("div",{className:"time"},"klo ",Object(L.a)(t,a))}var I=a(7);function K(e){var t=e.dayData,a=function(e){var t=e.items,a=e.startOfDay,n=[new Date,Object(O.a)(new Date,1),Object(O.a)(new Date,2)].filter((function(e){return Object(I.a)(e,a)})).map((function(e){return e.getHours()})).concat(C);return t.filter((function(e){return-1!==n.indexOf(e.ts.getHours())}))}({items:t.items,startOfDay:t.startOfDay});return 0===a.length?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"forecast-date"},r.a.createElement(q,{ts:t.startOfDay})),r.a.createElement("div",{className:"weather-container"},a.map((function(e,t){return r.a.createElement("div",{key:t,className:"weather-item"},r.a.createElement(A,{ts:e.ts}),r.a.createElement("div",{className:"weather-values"},r.a.createElement(V,{temperature:e.temperature,windspeedms:e.windspeedms,precipitation1h:e.precipitation1h})))}))))}function G(e){var t=e.data;return t?r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement(K,{key:t,dayData:e})}))):null}function $(e){var t=e.location,a=e.forecastData,n=e.onLocateClick;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"S\xe4\xe4ennuste:"," ",t?"".concat(t.lat,",").concat(t.lng):"ei sijaintia"),!t&&r.a.createElement("button",{onClick:n},"Paikanna"),r.a.createElement(G,{data:a}))}function _(e){var t=e.location,a=e.onLocateClick,i=Object(n.useState)(void 0),o=Object(c.a)(i,2),s=o[0],m=o[1],f=Object(n.useState)(void 0),p=Object(c.a)(f,2),d=p[0],v=p[1],b=Object(n.useState)(void 0),O=Object(c.a)(b,2),h=O[0],g=O[1],j=Object(n.useState)(0),w=Object(c.a)(j,2),y=w[0],E=w[1];Object(n.useEffect)((function(){var e=setTimeout((function(){return E((function(e){return e+1}))}),S);return function(){return clearTimeout(e)}}),[y]);var N=Object(n.useState)(!1),k=Object(c.a)(N,2),D=k[0],F=k[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(l.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!1),e.prev=1,e.next=4,x({location:t});case 4:a=e.sent,m(a),v(Date.now()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),F(!0);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();!s||JSON.stringify(h)!==JSON.stringify(t)||s&&d&&Date.now()-d>P?(console.log("Need forecast data refresh"),e(),g(t)):console.log("No need for forecast data refresh")}),[y,t]),r.a.createElement(r.a.Fragment,null,D&&"Virhe haettaessa viimeisimpi\xe4 ennusteita.",r.a.createElement($,{location:t,forecastData:s,onLocateClick:a}))}var z=function(){var e=Object(n.useState)(void 0),t=Object(c.a)(e,2),a=t[0],i=t[1];function o(e){var t={lat:e.coords.latitude.toFixed(2),lng:e.coords.longitude.toFixed(2)};JSON.stringify(a)!==JSON.stringify(t)?(console.log("Got new location",t),i(t)):console.log("Got same location")}function s(e){console.log(e)}function u(){console.log("Asking for location"),navigator.geolocation?navigator.geolocation.getCurrentPosition(o,s,{maximumAge:18e5}):console.log("No location support")}var l=Object(n.useState)(0),m=Object(c.a)(l,2),f=m[0],p=m[1];return Object(n.useEffect)((function(){var e=void 0;return void 0!==a&&(e=setTimeout((function(){return p((function(e){return e+1}))}),F)),function(){return clearTimeout(e)}}),[f,a]),Object(n.useEffect)((function(){void 0!==a&&u()}),[f]),Object(n.useEffect)((function(){navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then((function(e){console.log(e),"granted"===e.state&&u()}))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(_,{location:a,onLocateClick:u}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.01dc8d57.chunk.js.map